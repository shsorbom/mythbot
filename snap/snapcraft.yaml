name: smythbot # you probably want to 'snapcraft register <name>'
version: '0.0.1' # just for humans, typically '1.2+git' or '1.3.2'
base: core20
summary: A Matrix chatbot to control your Mythtv DVR # 79 char long summary
description: |
  This is my-snap's description. You have a paragraph or two to tell the
  most important story about your snap. Keep it under 100 words though,
  we live in tweetspace and your description wants to look good in the snap
  store.

grade: edge # must be 'stable' to release into candidate/stable channels
confinement: strict # use 'strict' once you have the right plugs and slots

environment:
  PYTHONPATH: $PYTHONPATH:$SNAP/lib/python3.8/site-packages


parts:
  smythbot:
    # See 'snapcraft plugins'
    plugin: python
    source: .
    stage-packages:
    - libmariadb3
    - python3-wheel
    build-environment:
      - PYTHONPATH: "$SNAPCRAFT_PART_INSTALL/usr/lib/python3/dist-packages" # https://forum.snapcraft.io/t/error-invalid-command-bdist-wheel/18960/3
    python-packages:
      - future
      - mysqlclient
      - matrix-nio
      - lxml
      - requests

  mythtv-bindings:
    plugin: python
    source: https://github.com/MythTV/mythtv
    source-type: git
    source-depth: 1
    source-subdir: mythtv/bindings/python
    stage-packages:
    - python3-wheel
    build-environment:
      - PYTHONPATH: "$SNAPCRAFT_PART_INSTALL/usr/lib/python3/dist-packages" # https://forum.snapcraft.io/t/error-invalid-command-bdist-wheel/18960/3
    filesets:
      include-bindings:
      - lib/python3.8/site-packages/MythTV/*
    stage:
      - $include-bindings
apps:
  smythbot:
    command: bin/smythbot.py
    plugs:
    - network 
    - network-bind
